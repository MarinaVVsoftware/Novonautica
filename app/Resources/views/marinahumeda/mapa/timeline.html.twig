{% extends 'estructura/plantilla.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet"
          href="{{ asset('css/fullcalendar.min.css') }}">
    <link rel="stylesheet"
          href="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/fullcalendar-scheduler/1.9.4/scheduler.min.css') }}">
    <style>
        dl {
            margin-bottom: 1rem;
        }

        .dl-horizontal dt {
            text-align: left;
        }

        .form-inline {
            margin-bottom: 2rem;
        }

        .form-inline .form-group {
            margin-right: 1rem;
        }

        .tooltip-inner {
            max-width: initial;
        }

        .tooltip-inner > .dl-horizontal > dt {
            width: 100px;
        }

        .tooltip-inner > .dl-horizontal > dd {
            text-align: left;
            margin-left: 100px;
        }
    </style>
{% endblock %}

{% block contwrapper %}
    <div class="content-wrapper">
        <section class="content">
            <div class="panel panel-novo">
                <div class="panel-heading">
                    <h3 class="panel-title">Slips Timeline</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div id='timeline'></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bower_components/moment/min/moment.min.js') }}"></script>
    <script src="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js') }}"></script>
    <script src="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/fullcalendar-scheduler/1.9.4/scheduler.min.js') }}"></script>
    <script src="{{ asset('bower_components/fullcalendar/dist/locale/es.js') }}"></script>
    <script>
      (function ($) {
        $('#timeline').fullCalendar({
          schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
          defaultView: 'timelineMonth',
          header: {
            left: '',
            center: 'prev,title,next',
            right: ''
          },
          views: {
            timelineMonth: {
              slotLabelFormat: [
                  'D'
              ]
            }
          },
          height: 300,
          resourceAreaWidth: '8%',
          resourceLabelText: 'Slips',
          resources: getResources(),
          events: 'events.json',
          eventRender: function (event, $element) {
            $element.tooltip({
              container: '.content-wrapper',
              html: true,
              placement: 'auto bottom',
              title: function () {
                return `
                    <dl class="dl-horizontal" style="margin-bottom: 0">
                      <dt>${event.title}</dt>
                      <dd></dd>
                      <dt>Llegada</dt>
                      <dd>${event.start.format('DD/MM/YYYY')}</dd>
                      <dt>Salida</dt>
                      <dd>${event.end.format('DD/MM/YYYY')}</dd>
                    </dl>
                `
              }
            })
          }
        });

        function getResources() {
          let resources = [];

          for (let i = 1; i <= 176; i++) {
            resources.push({id: i, title: '#' + i});
          }

          return resources;
        }
      })(jQuery);
    </script>
{% endblock %}