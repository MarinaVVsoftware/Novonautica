{% extends 'estructura/plantilla.twig' %}

{% block title %}
    Novonautica | Cotizaciones Astillero
{% endblock %}

{% block contwrapper %}
    <div class="content-wrapper">
        <section class="content">
            <div class="panel panel-novo">
                <div class="panel-heading">
                    <h3 class="panel-title">Astillero Cotizaciones</h3>
                </div>
                <div class="panel-body">
                    <div class="table-responsive scroll-novo">
                    <table class="table text-center">
                        <thead>
                        <tr>
                            <th>Folio</th>
                            <th>Cliente</th>
                            <th>Barco</th>
                            <th>Fecha llegada</th>
                            <th>Fecha salida</th>
                            <th>Subtotal</th>
                            <th>Ivatotal</th>
                            <th>Total</th>
                            <th>Validación</th>
                            <th>Aceptación</th>
                            <th>Pago</th>
                            <th>Acciones</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for astilleroCotizacion in astilleroCotizacions|reverse %}
                            <tr>
                                <td>
                                    {% if astilleroCotizacion.foliorecotiza == 0 %}
                                        {{astilleroCotizacion.folio }}
                                    {% else %}
                                        {{ astilleroCotizacion.folio }}-{{ astilleroCotizacion.foliorecotiza }}
                                    {% endif %}
                                </td>
                                <td>{{ astilleroCotizacion.cliente }}</td>
                                <td>{{ astilleroCotizacion.barco }}</td>

                                <td>{% if astilleroCotizacion.fechaLlegada %}{{ astilleroCotizacion.fechaLlegada|date('Y-m-d') }}{% endif %}</td>
                                <td>{% if astilleroCotizacion.fechaSalida %}{{ astilleroCotizacion.fechaSalida|date('Y-m-d') }}{% endif %}</td>
                                <td>$ {{ (astilleroCotizacion.subtotal/100)|number_format(2) }}</td>
                                <td>$ {{ (astilleroCotizacion.ivatotal/100)|number_format(2) }}</td>
                                <td>$ {{ (astilleroCotizacion.total/100)|number_format(2) }}</td>
                                <td class="align-middle">
                                    {% if astilleroCotizacion.validanovo == 0 %}
                                        <img src="{{ asset('img/status-pendiente-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Pendiente">
                                    {% elseif astilleroCotizacion.validanovo == 1 %}
                                        <img src="{{ asset('img/status-desaprovado-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Rechazado">
                                    {% elseif astilleroCotizacion.validanovo == 2 %}
                                        <img src="{{ asset('img/status-aprobado-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Aceptado">
                                    {% endif %}
                                </td>
                                <td class="align-middle">
                                    {% if astilleroCotizacion.validacliente == 0 %}
                                        <img src="{{ asset('img/status-pendiente-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Pendiente">
                                    {% elseif astilleroCotizacion.validacliente == 1 %}
                                        <img src="{{ asset('img/status-desaprovado-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Rechazado">
                                    {% elseif astilleroCotizacion.validacliente == 2 %}
                                        <img src="{{ asset('img/status-aprobado-icon.svg') }}"
                                             class="center-block" data-toggle="tooltip" data-placement="left" title="Aceptado">
                                    {% endif %}
                                </td>
                                <td class="align-middle">
                                    {% if astilleroCotizacion.validacliente == 2 %}
                                        {% if astilleroCotizacion.estatuspago == 2 %}
                                            <img src="{{ asset('img/status-aprobado-icon.svg') }}"
                                                 class="center-block" data-toggle="tooltip" data-placement="left" title="Pagado">
                                        {% elseif astilleroCotizacion.estatuspago == 1 %}
                                            <img src="{{ asset('img/status-pendiente-icon.svg') }}"
                                                 class="center-block" data-toggle="tooltip" data-placement="left" title="Con adeudo">
                                        {% else %}
                                            <img src="{{ asset('img/status-desaprovado-icon.svg') }}"
                                                 class="center-block" data-toggle="tooltip" data-placement="left" title="No pagado">
                                        {% endif %}
                                    {% endif %}
                                </td>
                                <td>
                                    <a class="btn btn-morado-claro" href="{{ path('astillero_show', { 'id': astilleroCotizacion.id }) }}">Detalle</a>
                                    {% if astilleroCotizacion.validanovo == 0 %}
                                        <a class="btn btn-azul" href="{{ path('astillero_validar', { 'id': astilleroCotizacion.id }) }}">Validar</a>
                                    {% endif %}
                                    {% if (astilleroCotizacion.validanovo == 1 or
                                        astilleroCotizacion.validacliente == 1) and
                                        astilleroCotizacion.estatus == 1
                                    %}
                                        <a class="btn btn-naranja" href="{{ path('astillero_recotizar', { 'id': astilleroCotizacion.id }) }}">Recotizar</a>
                                    {% endif %}
                                    {% if astilleroCotizacion.validacliente == 2 and astilleroCotizacion.estatusPago != 2 %}
                                        <a class="btn btn-verde" href="{{ path('astillero_cotizacion_pago_edit',{'id': astilleroCotizacion.id}) }}">Pagos</a>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    </div>
                </div>
            </div>
        </section>
    </div>
{% endblock %}
